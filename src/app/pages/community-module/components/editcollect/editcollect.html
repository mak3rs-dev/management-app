<ion-header>
  <ion-toolbar>
    <ion-title>Crear recogida</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">
        CANCELAR
      </ion-button>
      <ion-button (click)="save()" *ngIf="getDiff!=0">
        GUARDAR
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <form #registerForm="ngForm"  class="ion-padding" (submit)="save()">

    <h2>Solicitando recogida para {{data.user_name}}</h2>

    <ng-container *ngFor="let piece of data.pieces">
      <ion-card *ngIf="piece.units!='0'" style="display: flex; margin: 0 0 10px 0;">
        <img [src]="piece.picture||'/assets/icon/favicon.png'" style="max-width: 100px; max-height: 100px; padding: 10px;">
        <ion-card-header style="width: 100%;">
          <ion-card-title>{{piece.name}}</ion-card-title>
          <ion-card-subtitle>
            <ng-container *ngIf="piece">
              Fabricadas: {{piece.units_manufactured}} | Entregadas: {{piece.units_collected}} | Stock: {{piece.stock}}
            </ng-container>
            <ion-item>
              <ion-label>Cantidad solicitada</ion-label>
              <ion-input [name]="'units'+piece.uuid" type="number" [min]="0" [max]="piece.stock" [(ngModel)]="piece.units"></ion-input>
            </ion-item>
            <small>* El maker podrá reemplazar este número una vez realice la entrega</small>
          </ion-card-subtitle>
        </ion-card-header>
      </ion-card>
    </ng-container>

    <ion-item>
      <ion-grid>
        <ion-row>
          <ion-col>
            <ion-label>Dirección<ion-text color="danger">*</ion-text></ion-label>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-input [(ngModel)]="data.address" placeholder="Dirección" name="address"></ion-input>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-input [(ngModel)]="data.location" placeholder="Localidad" name="location"></ion-input>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-input [(ngModel)]="data.province" placeholder="Provincia" name="province"></ion-input>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-input [(ngModel)]="data.state" placeholder="Comunidad autónoma" name="state"></ion-input>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-input [(ngModel)]="data.country" placeholder="País" name="country"></ion-input>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-input [(ngModel)]="data.cp" placeholder="Código Postal" name="cp"></ion-input>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-textarea [(ngModel)]="data.address_description" placeholder="Comentario adicional" name="address_description"></ion-textarea>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-item>

    <div class="ion-padding" *ngIf="false">
      <ion-button expand="block" type="submit" class="ion-no-margin">Crear recogida</ion-button>
    </div>
  </form>

</ion-content>